<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pierre Osteil">
<meta name="dcterms.date" content="2023-10-15">

<title>TP N3S6 - Introduction Génomique Fonctionnelle 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="IGF_v1_files/libs/clipboard/clipboard.min.js"></script>
<script src="IGF_v1_files/libs/quarto-html/quarto.js"></script>
<script src="IGF_v1_files/libs/quarto-html/popper.min.js"></script>
<script src="IGF_v1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="IGF_v1_files/libs/quarto-html/anchor.min.js"></script>
<link href="IGF_v1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="IGF_v1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="IGF_v1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="IGF_v1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="IGF_v1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP N3S6 - Introduction Génomique Fonctionnelle 2024</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pierre Osteil </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="table-des-matières" class="level1">
<h1>Table des Matières</h1>
<ol type="1">
<li><a href="#Intro">Introduction</a></li>
<li><a href="#Partie1">Analyse de données RT-qPCR avec R-Studio</a>
<ol type="1">
<li><a href="#Partie1.1">Charger les packages</a></li>
<li><a href="#Partie1.2">Charger les données</a></li>
<li><a href="#Partie1.3">Permutation de table</a></li>
<li><a href="#Partie1.4">Ajout de metadata</a></li>
<li><a href="#Partie1.5">Calcul des delta Ct</a></li>
<li><a href="#Partie1.6">Ploting des résultats</a></li>
</ol></li>
</ol>
</section>
<section id="introduction" class="level1">
<h1>Introduction <a name="Intro" href=""></a></h1>
<p>Lors de ce TP vous avez reçu un numéro. Ce numéro correspond à un type cellulaire chez un mammifère. Le jeu consiste, grâce aux données que vous avez en main, à identifier à quel type cellulaire votre numéro correspond. Pour cela nous allons effectué un ensemble de lignes de commandes du logiciel R. Elle seront appliquées sur R Studio et l’ensemble des données produites pourra être visualisé grâce au programme Quarto, utilisé pour générer ce document.</p>
<p>Le TP sera réalisé sur 8 séances de 1H30. Un compte-rendu sera produit et comptera pour –% de la note finale de contôle continu. Le compte rendu sera réalisé en remplissant les sections indiquées sur ce document.</p>
</section>
<section id="analyse-de-données-rt-qpcr-avec-r-studio" class="level1">
<h1>Analyse de données RT-qPCR avec R-Studio <a name="Partie1" href=""></a></h1>
<section id="charger-les-packages" class="level2">
<h2 class="anchored" data-anchor-id="charger-les-packages">1. Charger les packages <a name="Partie1.2" href=""></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Installer les packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyr")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggplot2")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#charger les packageSlot</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Les objets suivants sont masqués depuis 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Les objets suivants sont masqués depuis 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="charger-les-données" class="level2">
<h2 class="anchored" data-anchor-id="charger-les-données">2. Charger les données <a name="Partie1.2" href=""></a></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>( <span class="st">"C:/Users/piosteil/Desktop/4-All_git/Cours/TP_Transcripto_N3S6/RT-qPCR/RT-qPCR_data.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">dec =</span> <span class="st">","</span>) <span class="co"># argument sep = "\t" pour tabulated, et dec = "," pour décimal </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><mark>Quelle sont les dimensions du jeu de données chargé? </mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RTqPCR_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60 13</code></pre>
</div>
</div>
<p><mark>Combien de réplicat par echantillons ont été effectué? </mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene Ech1_Rep1 Ech1_Rep2 Ech1_Rep3 Ech2_Rep1 Ech2_Rep2 Ech2_Rep3 Ech3_Rep1
1 Foxa2      18.2      18.9      19.0      20.9      21.3      21.8      22.7
2 Foxa2      17.7      18.4      18.9      20.8      21.4      22.4      22.4
3 Foxa2      17.5      18.1      19.1      20.7      21.2      23.0      22.9
4 Gata6      15.3      16.3      16.3      17.9      18.5      19.1      19.4
5 Gata6      14.9      16.1      16.7      17.8      18.9      19.9      19.4
6 Gata6      15.0      16.1      16.8      18.1      19.0      19.8      19.4
  Ech3_Rep2 Ech3_Rep3 CTR_Rep1 CTR_Rep2 CTR_Rep3
1      23.4      24.1     31.9     32.3     32.5
2      23.0      24.1     30.6     32.0     32.6
3      22.6      24.4     31.0     31.6     33.1
4      20.0      21.3     29.0     29.5     30.2
5      20.3      21.3     29.0     30.6     30.5
6      20.5      21.6     28.9     29.3     30.4</code></pre>
</div>
</div>
</section>
<section id="permutation-de-table" class="level2">
<h2 class="anchored" data-anchor-id="permutation-de-table">3. Permutation de table <a name="Partie1.3" href=""></a></h2>
<p>Les tableaux fourni par les machines d’analyses ne sont souvent pas adapté à la production de plots. L’utilisation de ggplot2 requiert une organisation spéciale avec pour chaque colonne un type de donnée. Nous allons donc réorganiser le tableau. Pour cela les fonctions du package tidyr vont nous permettre de manipuler le tableau sans aucun risque d’erreur de mauvaises manipulations de copier/coller</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dat_long <span class="ot">&lt;-</span> RTqPCR_dat <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">names_to =</span> <span class="st">"condition"</span>, <span class="at">values_to =</span> <span class="st">"Ct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><mark>Quelle sont les dimensions de cette nouvelle table? </mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RTqPCR_dat_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 720   3</code></pre>
</div>
</div>
<p><mark>Que fait pivot_longer()? </mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_dat_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Gene  condition    Ct
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
1 Foxa2 Ech1_Rep1  18.2
2 Foxa2 Ech1_Rep2  18.9
3 Foxa2 Ech1_Rep3  19  
4 Foxa2 Ech2_Rep1  20.9
5 Foxa2 Ech2_Rep2  21.3
6 Foxa2 Ech2_Rep3  21.8</code></pre>
</div>
</div>
</section>
<section id="ajout-de-metadata" class="level2">
<h2 class="anchored" data-anchor-id="ajout-de-metadata">4. Ajout de metadata <a name="Partie1.4" href=""></a></h2>
<p>Les données sont généralement brutes. Afin de présenter des plots compréhensible, il faut ajouter des métadata, qui sont des informations supplémentaire pour chaque échantillons.</p>
<p>Ici nous allons créer une colonne pour le nom de chaque échantillon et le nom de chaque réplicats.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Création d'un tableau à deux colonnes</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>metadata1 <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(RTqPCR_dat_long<span class="sc">$</span>condition, <span class="st">"_"</span>, <span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(metadata1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"echantillon"</span>, <span class="st">"bioRep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><mark>Que fait str_split_fixed()?</mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(metadata1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     echantillon bioRep
[1,] "Ech1"      "Rep1"
[2,] "Ech1"      "Rep2"
[3,] "Ech1"      "Rep3"
[4,] "Ech2"      "Rep1"
[5,] "Ech2"      "Rep2"
[6,] "Ech2"      "Rep3"</code></pre>
</div>
</div>
<p><mark>Quelle sont les dimensions de cette nouvelle table? Est-ce attendu? Commentez </mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metadata1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 720   2</code></pre>
</div>
</div>
<p>Combinez avec le tableau de résultats</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dat_long_meta <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(RTqPCR_dat_long, metadata1)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_dat_long_meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene condition   Ct echantillon bioRep
1 Foxa2 Ech1_Rep1 18.2        Ech1   Rep1
2 Foxa2 Ech1_Rep2 18.9        Ech1   Rep2
3 Foxa2 Ech1_Rep3 19.0        Ech1   Rep3
4 Foxa2 Ech2_Rep1 20.9        Ech2   Rep1
5 Foxa2 Ech2_Rep2 21.3        Ech2   Rep2
6 Foxa2 Ech2_Rep3 21.8        Ech2   Rep3</code></pre>
</div>
</div>
<p>Nous avons également une autre information qui va s’avérer utile pour la suite de notr analyse, qui est une ontologie sur les trois feuillet embryonnaires. Cette information se trouve dans un autre fichier “fonction_gène.txt”. Nous allons l’ouvrir et incorporer ces données aux tableaux de résultats</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>metadata2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/piosteil/Desktop/4-All_git/Cours/TP_Transcripto_N3S6/RT-qPCR/fonction_gène.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><mark>Quelle sont les dimensions de cette nouvelle table? Est-ce attendu? Commentez</mark></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metadata2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20  2</code></pre>
</div>
</div>
<p>Afin de compenser le nombre de ligne nous allons utiliser une autre fonction, merge()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dat_long_meta2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(RTqPCR_dat_long_meta, metadata2, <span class="at">by =</span> <span class="st">"Gene"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(RTqPCR_dat_long_meta2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Gene condition   Ct echantillon bioRep     Fonction
715 Zfp42 Ech3_Rep1 31.8        Ech3   Rep1 Pluripotence
716 Zfp42 Ech3_Rep2 32.1        Ech3   Rep2 Pluripotence
717 Zfp42 Ech3_Rep3 33.0        Ech3   Rep3 Pluripotence
718 Zfp42  CTR_Rep1 15.0         CTR   Rep1 Pluripotence
719 Zfp42  CTR_Rep2 15.6         CTR   Rep2 Pluripotence
720 Zfp42  CTR_Rep3 16.7         CTR   Rep3 Pluripotence</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RTqPCR_dat_long_meta2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 720   6</code></pre>
</div>
</div>
<p><mark>Comment fonctionne la fonction merge()?</mark></p>
</section>
<section id="calcul-des-delta-ct" class="level2">
<h2 class="anchored" data-anchor-id="calcul-des-delta-ct">5. Calcul des delta Ct <a name="Partie1.5" href=""></a></h2>
<p>La première étape va être de calculer les medianes de chaques réplicats techniques. Pour cela la table va être réduite.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_median <span class="ot">&lt;-</span> RTqPCR_dat_long_meta2 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(condition, Gene) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">MedCt =</span> <span class="fu">median</span>(Ct))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   condition, Gene [6]
  Gene  condition    Ct echantillon bioRep Fonction  MedCt
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;
1 Foxa2 Ech1_Rep1  18.2 Ech1        Rep1   Endoderme  17.7
2 Foxa2 Ech1_Rep2  18.9 Ech1        Rep2   Endoderme  18.4
3 Foxa2 Ech1_Rep3  19   Ech1        Rep3   Endoderme  19  
4 Foxa2 Ech2_Rep1  20.9 Ech2        Rep1   Endoderme  20.8
5 Foxa2 Ech2_Rep2  21.3 Ech2        Rep2   Endoderme  21.3
6 Foxa2 Ech2_Rep3  21.8 Ech2        Rep3   Endoderme  22.4</code></pre>
</div>
</div>
<p><mark>Pourquoi calcules-t-on la médiane et non pas la moyenne pour les réplicats techniques? </mark></p>
<p>Maintenant que les réplicats techniques ont été utilisés, on peut les enlever</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_median_clean <span class="ot">&lt;-</span> RTqPCR_median <span class="sc">|&gt;</span> <span class="fu">group_by</span>(condition, Gene) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(condition, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="co">#on va selectioner l'échantillon median à chaque fois</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(RTqPCR_median_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   condition, Gene [6]
  Gene  condition    Ct echantillon bioRep Fonction     MedCt
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;
1 Zfp42 Ech3_Rep1  31.7 Ech3        Rep1   Pluripotence  31.7
2 Zfp42 Ech3_Rep2  32.3 Ech3        Rep2   Pluripotence  32.1
3 Zfp42 Ech3_Rep3  32.8 Ech3        Rep3   Pluripotence  32.8
4 Zfp42 CTR_Rep1   15   CTR         Rep1   Pluripotence  15  
5 Zfp42 CTR_Rep2   16   CTR         Rep2   Pluripotence  15.6
6 Zfp42 CTR_Rep3   16.6 CTR         Rep3   Pluripotence  16.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(RTqPCR_median_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 240   7</code></pre>
</div>
</div>
<p><mark> A quoi sert la fonction “distinct”? </mark></p>
<p>Nous allons extraire les données du gènes de ménage (GDM), et calculer la moyenne pour chaque échantillon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_median_GDM <span class="ot">&lt;-</span> RTqPCR_median <span class="sc">|&gt;</span> <span class="fu">filter</span>(Fonction <span class="sc">==</span> <span class="st">"GDM"</span>) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_median_GDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   condition, Gene [6]
  Gene  condition    Ct echantillon bioRep Fonction MedCt
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 TBP   Ech1_Rep1  23   Ech1        Rep1   GDM       22.9
2 TBP   Ech1_Rep2  23.9 Ech1        Rep2   GDM       23.6
3 TBP   Ech1_Rep3  23.5 Ech1        Rep3   GDM       24  
4 TBP   Ech2_Rep1  23   Ech2        Rep1   GDM       22.9
5 TBP   Ech2_Rep2  22.6 Ech2        Rep2   GDM       23  
6 TBP   Ech2_Rep3  24   Ech2        Rep3   GDM       24  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(RTqPCR_median_GDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
</div>
<p>Nous allons maintenant produire notre premier plot. Il s’agit de représenter la distibution des valeur moyenne de Ct en fonction des réplicats biologiques et des différent échantillons. Pour ceci nous allons utiliser un boxplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(RTqPCR_median_GDM, <span class="fu">aes</span>(<span class="at">x =</span> echantillon, <span class="at">y =</span> MedCt))<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"slateblue"</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>))<span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IGF_v1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><mark> Quelle conclusion tirez-vous de ce plot? </mark></p>
<p>L’objectif va être de soustraire les valeurs de Ct obtenu sur le GDM au valeurs de nos gènes. Dans un premier temps nous ajoutons la colonne MeanCT_GDM à notre tableau principal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#on ne garde que les deux colonne d'interêt</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>RTqPCR_median_GDM_clean <span class="ot">&lt;-</span> RTqPCR_median_GDM <span class="sc">|&gt;</span> <span class="fu">select</span>(Gene, echantillon, condition, MedCt) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(condition, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>RTqPCR_mean_GDM <span class="ot">&lt;-</span> RTqPCR_median_GDM_clean <span class="sc">|&gt;</span> <span class="fu">group_by</span>(echantillon) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">MeanCt_GDM =</span> <span class="fu">mean</span>(MedCt)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(echantillon, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()<span class="sc">|&gt;</span> <span class="fu">select</span>(condition, MeanCt_GDM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><mark> Discutez des deux opérations ci dessus. Quel est le but de la deuxième opération? </mark></p>
<p>on fucionne les deux tables pour ajouter les moyenne du GDM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dCt <span class="ot">&lt;-</span> <span class="fu">merge</span>(RTqPCR_median_clean, RTqPCR_mean_GDM,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"condition"</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_dCt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  condition  Gene   Ct echantillon bioRep     Fonction MedCt MeanCt_GDM
1  CTR_Rep1  Klf4 14.9         CTR   Rep1 Pluripotence  14.9       23.3
2  CTR_Rep1 Hnf4a 33.2         CTR   Rep1    Endoderme  32.9       23.3
3  CTR_Rep1 Gata6 29.0         CTR   Rep1    Endoderme  29.0       23.3
4  CTR_Rep1 Foxa2 31.9         CTR   Rep1    Endoderme  31.0       23.3
5  CTR_Rep1 Nanog 15.2         CTR   Rep1 Pluripotence  15.0       23.3
6  CTR_Rep1 Mixl1 31.7         CTR   Rep1    Mesoderme  31.5       23.3</code></pre>
</div>
</div>
<p>On peut maintenant soustraire les MeanCT_GDM le MedCt de nos replicats techniques pour chaques gène à la moyenne de la valeur du GDM pour cet échantillon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>RTqPCR_dCt <span class="ot">&lt;-</span> RTqPCR_dCt <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dCt =</span> <span class="dv">2</span><span class="sc">^-</span>(MedCt<span class="sc">-</span>MeanCt_GDM))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RTqPCR_dCt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  condition  Gene   Ct echantillon bioRep     Fonction MedCt MeanCt_GDM
1  CTR_Rep1  Klf4 14.9         CTR   Rep1 Pluripotence  14.9       23.3
2  CTR_Rep1 Hnf4a 33.2         CTR   Rep1    Endoderme  32.9       23.3
3  CTR_Rep1 Gata6 29.0         CTR   Rep1    Endoderme  29.0       23.3
4  CTR_Rep1 Foxa2 31.9         CTR   Rep1    Endoderme  31.0       23.3
5  CTR_Rep1 Nanog 15.2         CTR   Rep1 Pluripotence  15.0       23.3
6  CTR_Rep1 Mixl1 31.7         CTR   Rep1    Mesoderme  31.5       23.3
           dCt
1 3.377940e+02
2 1.288582e-03
3 1.923663e-02
4 4.809158e-03
5 3.151730e+02
6 3.400588e-03</code></pre>
</div>
</div>
</section>
<section id="ploting-des-résultats" class="level2">
<h2 class="anchored" data-anchor-id="ploting-des-résultats">6. Ploting des résultats <a name="Partie1.6" href=""></a></h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>